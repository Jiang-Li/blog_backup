import pandas as pd
def oneway(g):
return(
pd.Series({
"measure1": g.measure1.sum(),
"measure2": g.measure2.sum(),
"count": len(g),
"measure1_percent": g.measure1.sum()/df.measure1.sum(),
"ratio": g.measure1.sum()/g.measure2.sum(),
"ratio_relativity":
(g.measure1.sum()/g.measure2.sum())/
(df.measure1.sum()/df.measure2.sum())
})
)
df.groupby("dimension1").apply(oneway)
df = pd.read_csv("sample.csv")
def oneway(g):
return(
pd.Series({
"measure1": g.measure1.sum(),
"measure2": g.measure2.sum(),
"count": len(g),
"measure1_percent": g.measure1.sum()/df.measure1.sum(),
"ratio": g.measure1.sum()/g.measure2.sum(),
"ratio_relativity":
(g.measure1.sum()/g.measure2.sum())/
(df.measure1.sum()/df.measure2.sum())
})
)
df.groupby("dimension1").apply(oneway)
list(df)
pd.melt(df,
id_vars=['dimension1', 'dimension2'],
value_vars=['measure1', 'measure2'])
